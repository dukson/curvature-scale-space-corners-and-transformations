<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ImageProcesser.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jacoco Report</a> &gt; <a href="index.html" class="el_package">algorithms.imageProcessing</a> &gt; <span class="el_source">ImageProcesser.java</span></div><h1>ImageProcesser.java</h1><pre class="source lang-java linenums">package algorithms.imageProcessing;

import java.util.logging.Logger;

/**
 *
 * @author nichole
 */
<span class="fc" id="L9">public class ImageProcesser {</span>
    
<span class="fc" id="L11">    protected Logger log = Logger.getLogger(this.getClass().getName());</span>

    public void applySobelKernel(Image input) {
        
<span class="fc" id="L15">        IKernel kernel = new SobelX();</span>
<span class="fc" id="L16">        Kernel kernelX = kernel.getKernel();</span>
        
<span class="fc" id="L18">        float normX = kernel.getNormalizationFactor();</span>
        
<span class="fc" id="L20">        kernel = new SobelY();</span>
<span class="fc" id="L21">        Kernel kernelY = kernel.getKernel();</span>
        
<span class="fc" id="L23">        float normY = kernel.getNormalizationFactor();</span>
       
<span class="fc" id="L25">        applyKernels(input, kernelX, kernelY, normX, normY);</span>
<span class="fc" id="L26">    }</span>
    
    protected void applyKernels(Image input, Kernel kernelX, Kernel kernelY, 
        float normFactorX, float normFactorY) {
                
        /*
        assumes that kernelX is applied to a copy of the img
        and kernelY is applied to a separate copy of the img and
        then they are added in quadrature for the final result.
        */
        
<span class="fc" id="L37">        Image imgX = input.copyImage();</span>
        
<span class="fc" id="L39">        Image imgY = input.copyImage();</span>
        
<span class="fc" id="L41">        applyKernel(imgX, kernelX, normFactorX);</span>
        
<span class="fc" id="L43">        applyKernel(imgY, kernelY, normFactorY);</span>
        
<span class="fc" id="L45">        Image img2 = combineConvolvedImages(imgX, imgY);</span>
        
<span class="fc" id="L47">        input.resetTo(img2);</span>
<span class="fc" id="L48">    }</span>
    
    public Image combineConvolvedImages(Image imageX, Image imageY) {
          
<span class="fc" id="L52">        Image img2 = new Image(imageX.getWidth(), imageX.getHeight());</span>
        
<span class="fc bfc" id="L54" title="All 2 branches covered.">        for (int i = 0; i &lt; imageX.getWidth(); i++) {</span>
<span class="fc bfc" id="L55" title="All 2 branches covered.">            for (int j = 0; j &lt; imageX.getHeight(); j++) {</span>
                
<span class="fc" id="L57">                int rX = imageX.getR(i, j);</span>
<span class="fc" id="L58">                int gX = imageX.getG(i, j);</span>
<span class="fc" id="L59">                int bX = imageX.getB(i, j);</span>
                
<span class="fc" id="L61">                int rY = imageY.getR(i, j);</span>
<span class="fc" id="L62">                int gY = imageY.getG(i, j);</span>
<span class="fc" id="L63">                int bY = imageY.getB(i, j);</span>
                
<span class="fc" id="L65">                double r = Math.sqrt(rX*rX + rY*rY);</span>
<span class="fc" id="L66">                double g = Math.sqrt(gX*gX + gY*gY);</span>
<span class="fc" id="L67">                double b = Math.sqrt(bX*bX + bY*bY);</span>
                
<span class="fc bfc" id="L69" title="All 2 branches covered.">                r = (r &gt; 255) ? 255 : r;</span>
<span class="fc bfc" id="L70" title="All 2 branches covered.">                g = (g &gt; 255) ? 255 : g;</span>
<span class="fc bfc" id="L71" title="All 2 branches covered.">                b = (b &gt; 255) ? 255 : b;</span>
                                    
                //int rgb = (int)(((rSum &amp; 0x0ff) &lt;&lt; 16) 
                //    | ((gSum &amp; 0x0ff) &lt;&lt; 8) | (bSum &amp; 0x0ff));
                    
<span class="fc" id="L76">                img2.setRGB(i, j, (int)r, (int)g, (int)b);</span>
            }
        }
        
<span class="fc" id="L80">        return img2;</span>
    }
    
    /**
     * process only the green channel and set red and blue to zero
     * @param imageX
     * @param imageY
     * @return 
     */
    public GreyscaleImage combineConvolvedImages(final GreyscaleImage imageX, 
        final GreyscaleImage imageY) {
          
<span class="fc" id="L92">        GreyscaleImage img2 = new GreyscaleImage(imageX.getWidth(), imageX.getHeight());</span>
        
<span class="fc bfc" id="L94" title="All 2 branches covered.">        for (int i = 0; i &lt; imageX.getWidth(); i++) {</span>
<span class="fc bfc" id="L95" title="All 2 branches covered.">            for (int j = 0; j &lt; imageX.getHeight(); j++) {</span>
                
<span class="fc" id="L97">                int gX = imageX.getValue(i, j);</span>
                
<span class="fc" id="L99">                int gY = imageY.getValue(i, j);</span>
                
                //double g = Math.sqrt(0.5*(gX*gX + gY*gY));
                
                //g = (g &gt; 255) ? 255 : g;
                
<span class="fc" id="L105">                double g = Math.sqrt(gX*gX + gY*gY);</span>
                
<span class="pc bpc" id="L107" title="1 of 2 branches missed.">                if (g &gt; 255) {</span>
<span class="nc" id="L108">                    g = 255;</span>
                }
                                    
                //int rgb = (int)(((rSum &amp; 0x0ff) &lt;&lt; 16) 
                //    | ((gSum &amp; 0x0ff) &lt;&lt; 8) | (bSum &amp; 0x0ff));
                 
<span class="fc" id="L114">                img2.setValue(i, j, (int)g);</span>
            }
        }
        
<span class="fc" id="L118">        return img2;</span>
    }
    
    /**
     * apply kernel to input. NOTE, that because the image is composed of vectors
     * that should have values between 0 and 255, inclusive, if the kernel application
     * results in a value outside of that range, the value is reset to 0 or
     * 255.
     * @param input
     * @param kernel
     * @param normFactor 
     */
    protected void applyKernel(Image input, Kernel kernel, float normFactor) {
       
<span class="fc" id="L132">        int h = (kernel.getWidth() - 1) &gt;&gt; 1;</span>
        
<span class="fc" id="L134">        Image output = new Image(input.getWidth(), input.getHeight());</span>
                 
<span class="fc bfc" id="L136" title="All 2 branches covered.">        for (int i = 0; i &lt; input.getWidth(); i++) {</span>
<span class="fc bfc" id="L137" title="All 2 branches covered.">            for (int j = 0; j &lt; input.getHeight(); j++) {</span>
                
<span class="fc" id="L139">                long rValue = 0;</span>
<span class="fc" id="L140">                long gValue = 0;</span>
<span class="fc" id="L141">                long bValue = 0;</span>
                
                // apply the kernel to pixels centered in (i, j)
                
<span class="fc bfc" id="L145" title="All 2 branches covered.">                for (int col = 0; col &lt; kernel.getWidth(); col++) {</span>
                    
<span class="fc" id="L147">                    int x = col - h;</span>
                    
<span class="fc" id="L149">                    int imgX = i + x;</span>
                    
                    // edge corrections.  use replication
<span class="fc bfc" id="L152" title="All 2 branches covered.">                    if (imgX &lt; 0) {</span>
<span class="fc" id="L153">                        imgX = -1 * imgX - 1;</span>
<span class="fc bfc" id="L154" title="All 2 branches covered.">                    } else if (imgX &gt;= input.getWidth()) {</span>
<span class="fc" id="L155">                        int diff = imgX - input.getWidth();</span>
<span class="fc" id="L156">                        imgX = input.getWidth() - diff - 1;</span>
                    }
                    
<span class="fc bfc" id="L159" title="All 2 branches covered.">                    for (int row = 0; row &lt; kernel.getHeight(); row++) {</span>
                        
<span class="fc" id="L161">                        int y = row - h;</span>
                        
<span class="fc" id="L163">                        int imgY = j + y;</span>
                        
                        // edge corrections.  use replication
<span class="fc bfc" id="L166" title="All 2 branches covered.">                        if (imgY &lt; 0) {</span>
<span class="fc" id="L167">                            imgY = -1 * imgY - 1;</span>
<span class="fc bfc" id="L168" title="All 2 branches covered.">                        } else if (imgY &gt;= input.getHeight()) {</span>
<span class="fc" id="L169">                            int diff = imgY - input.getHeight();</span>
<span class="fc" id="L170">                            imgY = input.getHeight() - diff - 1;</span>
                        }
                        
<span class="fc" id="L173">                        int rPixel = input.getR(imgX, imgY);</span>
<span class="fc" id="L174">                        int gPixel = input.getG(imgX, imgY);</span>
<span class="fc" id="L175">                        int bPixel = input.getB(imgX, imgY);</span>

<span class="fc" id="L177">                        int k = kernel.getValue(col, row);</span>

<span class="fc" id="L179">                        rValue += k * rPixel;</span>
<span class="fc" id="L180">                        gValue += k * gPixel;</span>
<span class="fc" id="L181">                        bValue += k * bPixel;</span>
                    }
                }
                
<span class="fc" id="L185">                rValue *= normFactor;</span>
<span class="fc" id="L186">                gValue *= normFactor;</span>
<span class="fc" id="L187">                bValue *= normFactor;</span>
                
                /*
                if ((rValue &gt; 255) || (rValue &lt; 0)) {
                    throw new IllegalStateException(&quot;rValue is &quot; + rValue);
                }
                if ((gValue &gt; 255) || (gValue &lt; 0)) {
                    throw new IllegalStateException(&quot;gValue is &quot; + gValue);
                }
                if ((bValue &gt; 255) || (bValue &lt; 0)) {
                    throw new IllegalStateException(&quot;bValue is &quot; + bValue);
                }*/
                
<span class="fc bfc" id="L200" title="All 2 branches covered.">                if (rValue &lt; 0) {</span>
<span class="fc" id="L201">                    rValue = 0;</span>
                }
<span class="fc bfc" id="L203" title="All 2 branches covered.">                if (rValue &gt; 255) {</span>
<span class="fc" id="L204">                    rValue = 255;</span>
                }
<span class="fc bfc" id="L206" title="All 2 branches covered.">                if (gValue &lt; 0) {</span>
<span class="fc" id="L207">                    gValue = 0;</span>
                }
<span class="fc bfc" id="L209" title="All 2 branches covered.">                if (gValue &gt; 255) {</span>
<span class="fc" id="L210">                    gValue = 255;</span>
                }
<span class="fc bfc" id="L212" title="All 2 branches covered.">                if (bValue &lt; 0) {</span>
<span class="fc" id="L213">                    bValue = 0;</span>
                }
<span class="fc bfc" id="L215" title="All 2 branches covered.">                if (bValue &gt; 255) {</span>
<span class="fc" id="L216">                    bValue = 255;</span>
                }

<span class="fc" id="L219">                output.setRGB(i, j, (int)rValue, (int)gValue, (int)bValue);</span>
            }
        }
        
<span class="fc" id="L223">        input.resetTo(output);</span>
<span class="fc" id="L224">    }</span>
 
    public Image computeTheta(Image convolvedX, Image convolvedY) {

<span class="fc" id="L228">        Image output = new Image(convolvedX.getWidth(), convolvedX.getHeight());</span>
        
<span class="fc bfc" id="L230" title="All 2 branches covered.">        for (int i = 0; i &lt; convolvedX.getWidth(); i++) {</span>
<span class="fc bfc" id="L231" title="All 2 branches covered.">            for (int j = 0; j &lt; convolvedX.getHeight(); j++) {</span>
                
<span class="fc" id="L233">                double rX = convolvedX.getR(i, j);</span>
<span class="fc" id="L234">                double gX = convolvedX.getG(i, j);</span>
<span class="fc" id="L235">                double bX = convolvedX.getB(i, j);</span>
                
<span class="fc" id="L237">                double rY = convolvedY.getR(i, j);</span>
<span class="fc" id="L238">                double gY = convolvedY.getG(i, j);</span>
<span class="fc" id="L239">                double bY = convolvedY.getB(i, j);</span>
                
<span class="fc" id="L241">                int thetaR = calculateTheta(rX, rY);</span>
<span class="fc" id="L242">                int thetaG = calculateTheta(gX, gY);</span>
<span class="fc" id="L243">                int thetaB = calculateTheta(bX, bY);</span>
                
<span class="fc" id="L245">                output.setRGB(i, j, thetaR, thetaG, thetaB);</span>
            }
        }
        
<span class="fc" id="L249">        return output;</span>
    }
    
    public GreyscaleImage computeTheta(final GreyscaleImage convolvedX, 
        final GreyscaleImage convolvedY) {

<span class="fc" id="L255">        GreyscaleImage output = new GreyscaleImage(convolvedX.getWidth(), </span>
            convolvedX.getHeight());
        
<span class="fc bfc" id="L258" title="All 2 branches covered.">        for (int i = 0; i &lt; convolvedX.getWidth(); i++) {</span>
<span class="fc bfc" id="L259" title="All 2 branches covered.">            for (int j = 0; j &lt; convolvedX.getHeight(); j++) {</span>
                
<span class="fc" id="L261">                double gX = convolvedX.getValue(i, j);</span>
                
<span class="fc" id="L263">                double gY = convolvedY.getValue(i, j);</span>
                
<span class="fc" id="L265">                int thetaG = calculateTheta(gX, gY);</span>
                
<span class="fc" id="L267">                output.setValue(i, j, thetaG);</span>
                
            }
        }
        
<span class="fc" id="L272">        return output;</span>
    }
    
    public GreyscaleImage subtractImages(final GreyscaleImage image, 
        final GreyscaleImage subtrImage) {
        
<span class="pc bpc" id="L278" title="1 of 2 branches missed.">        if (image.getWidth() != subtrImage.getWidth()) {</span>
<span class="nc" id="L279">            throw new IllegalArgumentException(&quot;image widths must be the same&quot;);</span>
        }
<span class="pc bpc" id="L281" title="1 of 2 branches missed.">        if (image.getHeight() != subtrImage.getHeight()) {</span>
<span class="nc" id="L282">            throw new IllegalArgumentException(&quot;image heights must be the same&quot;);</span>
        }
        
<span class="fc" id="L285">        GreyscaleImage output = new GreyscaleImage(image.getWidth(), image.getHeight());</span>
        
<span class="fc bfc" id="L287" title="All 2 branches covered.">        for (int i = 0; i &lt; image.getWidth(); i++) {</span>
<span class="fc bfc" id="L288" title="All 2 branches covered.">            for (int j = 0; j &lt; image.getHeight(); j++) {</span>
                
<span class="fc" id="L290">                int diff = image.getValue(i, j) - subtrImage.getValue(i, j);</span>
                
<span class="fc" id="L292">                output.setValue(i, j, diff);</span>
            }
        }
        
<span class="fc" id="L296">        return output;</span>
    }
    
    protected int calculateTheta(double gradientX, double gradientY) {
        
        /*  -45    90    45          y/x
                -  |  +
            0 -----|----- 0
                +  |  -   
            45    90    -45
        
           when X is 0: if Y &gt; 0, theta is 90
           when Y is 0: if X &gt;= 0, theta is 0
        */
        
<span class="fc bfc" id="L311" title="All 4 branches covered.">        if (gradientX == 0 &amp;&amp; (gradientY != 0)) {</span>
<span class="fc" id="L312">            return 90;</span>
        }
        
<span class="fc bfc" id="L315" title="All 2 branches covered.">        if (gradientY == 0) {</span>
<span class="fc" id="L316">            return 0;</span>
        }
        
<span class="fc" id="L319">        double div = gradientY/gradientX;</span>
                
<span class="fc" id="L321">        double theta = Math.atan(div)*180./Math.PI;</span>
        
<span class="fc" id="L323">        int angle = (int)theta;</span>
      
        // +x, +y -&gt; +
        // -x, +y -&gt; -
        // -x, -y -&gt; +
        // +x, -y -&gt; -
        
<span class="fc bfc" id="L330" title="All 4 branches covered.">        if (!(gradientX &lt; 0) &amp;&amp; !(gradientY &lt; 0)) {</span>
<span class="pc bpc" id="L331" title="1 of 2 branches missed.">            if (angle &lt; 0) {</span>
                // make it positive if negative
<span class="nc" id="L333">                angle *= -1;</span>
            }
<span class="fc bfc" id="L335" title="All 4 branches covered.">        } else if ((gradientX &lt; 0) &amp;&amp; !(gradientY &lt; 0)) {</span>
<span class="fc bfc" id="L336" title="All 2 branches covered.">            if (!(angle &lt; 0)) {</span>
                // make it negative if it's not
<span class="fc" id="L338">                angle *= -1;</span>
            }
<span class="pc bpc" id="L340" title="1 of 4 branches missed.">        } else if ((gradientX &lt; 0) &amp;&amp; (gradientY &lt; 0)) {</span>
<span class="pc bpc" id="L341" title="1 of 2 branches missed.">            if (angle &lt; 0) {</span>
                // make it positive if negative
<span class="nc" id="L343">                angle *= -1;</span>
            }
<span class="pc bpc" id="L345" title="2 of 4 branches missed.">        } else if (!(gradientX &lt; 0) &amp;&amp; (gradientY &lt; 0)) {</span>
<span class="fc bfc" id="L346" title="All 2 branches covered.">            if (!(angle &lt; 0)) {</span>
                // make it negative if it's not
<span class="fc" id="L348">                angle *= -1;</span>
            }
        }
        
<span class="fc" id="L352">        return angle;</span>
    }
    
    /**
     * images bounded by zero's have to be shrunk to the columns and rows
     * of the first non-zeroes in order to keep the lines that should be
     * attached to the image edges from eroding completely.
     * 
     * @param input
     * @return 
     */
    public int[] shrinkImageToFirstNonZeros(final GreyscaleImage input) {
        
<span class="fc" id="L365">        int xNZFirst = -1;</span>
<span class="fc" id="L366">        int xNZLast = -1;</span>
<span class="fc" id="L367">        int yNZFirst = -1;</span>
<span class="fc" id="L368">        int yNZLast = -1;</span>
        
<span class="pc bpc" id="L370" title="1 of 2 branches missed.">        for (int i = 0; i &lt; input.getWidth(); i++) {</span>
<span class="fc bfc" id="L371" title="All 2 branches covered.">            for (int j = 0; j &lt; input.getHeight(); j++) {</span>
<span class="fc" id="L372">                int pixValue = input.getValue(i, j);</span>
<span class="fc bfc" id="L373" title="All 2 branches covered.">                if (pixValue &gt; 0) {</span>
<span class="fc" id="L374">                    xNZFirst = i;</span>
<span class="fc" id="L375">                    break;</span>
                }
            }
<span class="fc bfc" id="L378" title="All 2 branches covered.">            if (xNZFirst &gt; -1) {</span>
<span class="fc" id="L379">                break;</span>
            }
        }
<span class="pc bpc" id="L382" title="1 of 2 branches missed.">        for (int j = 0; j &lt; input.getHeight(); j++) {</span>
<span class="fc bfc" id="L383" title="All 2 branches covered.">            for (int i = 0; i &lt; input.getWidth(); i++) {</span>
<span class="fc" id="L384">                int pixValue = input.getValue(i, j);</span>
<span class="fc bfc" id="L385" title="All 2 branches covered.">                if (pixValue &gt; 0) {</span>
<span class="fc" id="L386">                    yNZFirst = j;</span>
<span class="fc" id="L387">                    break;</span>
                }
            }
<span class="fc bfc" id="L390" title="All 2 branches covered.">            if (yNZFirst &gt; -1) {</span>
<span class="fc" id="L391">                break;</span>
            }
        }
        
<span class="pc bpc" id="L395" title="1 of 2 branches missed.">        for (int i = (input.getWidth() - 1); i &gt; -1; i--) {</span>
<span class="fc bfc" id="L396" title="All 2 branches covered.">            for (int j = (input.getHeight() - 1); j &gt; -1; j--) {</span>
<span class="fc bfc" id="L397" title="All 2 branches covered.">                if (input.getValue(i, j) &gt; 0) {</span>
<span class="fc" id="L398">                    xNZLast = i;                    </span>
<span class="fc" id="L399">                    break;</span>
                }
            }
<span class="fc bfc" id="L402" title="All 2 branches covered.">            if (xNZLast &gt; -1) {</span>
<span class="fc" id="L403">                break;</span>
            }
        }
        
<span class="pc bpc" id="L407" title="1 of 2 branches missed.">        for (int j = (input.getHeight() - 1); j &gt; -1; j--) {</span>
<span class="fc bfc" id="L408" title="All 2 branches covered.">            for (int i = (input.getWidth() - 1); i &gt; -1; i--) {</span>
<span class="fc" id="L409">                int pixValue = input.getValue(i, j);</span>
<span class="fc bfc" id="L410" title="All 2 branches covered.">                if (pixValue &gt; 0) {</span>
<span class="fc" id="L411">                    yNZLast = j;                    </span>
<span class="fc" id="L412">                    break;</span>
                }
            }
<span class="fc bfc" id="L415" title="All 2 branches covered.">            if (yNZLast &gt; -1) {</span>
<span class="fc" id="L416">                break;</span>
            }
        }
        
<span class="pc bpc" id="L420" title="1 of 8 branches missed.">        if ((xNZFirst &gt; 0) || (xNZLast &lt; (input.getWidth() - 1)) </span>
            || (yNZFirst &gt; 0) || (yNZLast &lt; (input.getHeight() - 1))) {
            
            //add a 2 pix border
<span class="fc" id="L424">            xNZFirst -= 2;</span>
<span class="fc" id="L425">            yNZFirst -= 2;</span>
<span class="fc bfc" id="L426" title="All 2 branches covered.">            if (xNZFirst &lt; 0) {</span>
<span class="fc" id="L427">                xNZFirst = 0;</span>
            }
<span class="fc bfc" id="L429" title="All 2 branches covered.">            if (yNZFirst &lt; 0) {</span>
<span class="fc" id="L430">                yNZFirst = 0;</span>
            }
<span class="pc bpc" id="L432" title="1 of 2 branches missed.">            if (xNZLast == -1) {</span>
<span class="nc" id="L433">                xNZLast = input.getWidth() - 1;</span>
<span class="fc bfc" id="L434" title="All 2 branches covered.">            } else if (xNZLast &lt; (input.getWidth() - 2)) {</span>
                // add a 1 pix border
<span class="fc" id="L436">                xNZLast += 2;</span>
<span class="fc bfc" id="L437" title="All 2 branches covered.">            } else if (xNZLast &lt; (input.getWidth() - 1)) {</span>
                // add a 1 pix border
<span class="fc" id="L439">                xNZLast++;</span>
            }
<span class="pc bpc" id="L441" title="1 of 2 branches missed.">            if (yNZLast == -1) {</span>
<span class="nc" id="L442">                yNZLast = input.getHeight() - 1;</span>
<span class="fc bfc" id="L443" title="All 2 branches covered.">            } else if (yNZLast &lt; (input.getHeight() - 2)) {</span>
                // add a 1 pix border
<span class="fc" id="L445">                yNZLast += 2;</span>
<span class="fc bfc" id="L446" title="All 2 branches covered.">            } else if (yNZLast &lt; (input.getHeight() - 1)) {</span>
                // add a 1 pix border
<span class="fc" id="L448">                yNZLast++;</span>
            }
            
<span class="fc" id="L451">            int xLen = xNZLast - xNZFirst + 1;</span>
            
<span class="fc" id="L453">            int yLen = yNZLast - yNZFirst + 1;</span>
            
<span class="fc" id="L455">            GreyscaleImage output = new GreyscaleImage(xLen, yLen);</span>
            
<span class="fc bfc" id="L457" title="All 2 branches covered.">            for (int i = xNZFirst; i &lt;= xNZLast; i++) {</span>
                
<span class="fc" id="L459">                int iIdx = i - xNZFirst;</span>
                
<span class="fc bfc" id="L461" title="All 2 branches covered.">                for (int j = yNZFirst; j &lt;= yNZLast; j++) {</span>
                    
<span class="fc" id="L463">                    int jIdx = j - yNZFirst;</span>
                    
<span class="fc" id="L465">                    output.setValue(iIdx, jIdx, input.getValue(i, j));</span>
                }
            }
            
<span class="fc" id="L469">            input.resetTo(output);</span>
            
<span class="fc" id="L471">            return new int[]{xNZFirst, yNZFirst};</span>
        }
        
<span class="fc" id="L474">        return new int[]{0, 0};</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.3.201306030806</span></div></body></html>